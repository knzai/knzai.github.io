{%- macro smart_img(path, default='') -%}
   {%- set png = get_image_metadata(path=path ~ '.png', allow_missing=true) -%}
   {%- set jpg = get_image_metadata(path=path ~ '.jpg', allow_missing=true) -%}
   {%- if png -%}
      {%- set path = path ~ '.png' -%}
   {%- elif jpg -%}
      {%- set path = path ~ '.jpg' -%}
   {%- else -%}
      {%- set path = default -%}
   {%- endif -%}
   {{- get_url(path=path) -}}
{%- endmacro smart_img -%}